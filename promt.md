# Создание автоматического генератора презентаций с использованием ИИ

## Описание проекта
Разработай веб-приложение, которое автоматически генерирует профессиональные презентации в форматах PDF и PPTX, используя искусственный интеллект. Пользователь вводит тему и параметры, а приложение создаёт полноценную презентацию с содержанием, структурой и визуальными элементами.

## Основные функции приложения:
1. Получение темы и параметров от пользователя
2. Автоматическая генерация содержания презентации с использованием ИИ
3. Создание структурированных слайдов с заголовками, текстом и визуальными элементами
4. Оформление презентации по выбранному стилю
5. Экспорт готовой презентации в форматы PDF или PPTX
6. Предоставление ссылки для скачивания созданной презентации

## Технологический стек:
- **Backend**: Node.js с Express
- **Frontend**: HTML/CSS/JavaScript (можно использовать React, если знаком)
- **ИИ для генерации контента**: OpenAI API (GPT-4 или GPT-3.5)
- **Создание PPTX**: библиотека PptxGenJS
- **Создание PDF**: библиотека PDFKit
- **Работа с HTTP-запросами**: Axios

## Пошаговая инструкция по разработке:

### Шаг 1: Настройка проекта
1. Создай новый проект Node.js
2. Установи необходимые зависимости:
   - express (для веб-сервера)
   - pptxgenjs (для создания PowerPoint презентаций)
   - pdfkit (для создания PDF документов)
   - openai (для работы с OpenAI API)
   - axios (для HTTP-запросов)
   - cors (для кросс-доменных запросов)
   - body-parser (для обработки JSON)
3. Создай базовую структуру проекта с папками для:
   - сервисов (services)
   - маршрутов (routes)
   - публичных файлов (public)

### Шаг 2: Создание сервиса генерации контента
1. Разработай сервис, который будет взаимодействовать с OpenAI API
2. Создай функцию, принимающую параметры презентации:
   - Тема
   - Количество слайдов
   - Целевая аудитория
   - Дополнительные требования
   - Стиль оформления
3. Сформируй промпт для OpenAI, который:
   - Опишет структуру презентации (титульный слайд, введение, основная часть, заключение)
   - Потребует для каждого слайда заголовок, содержимое и описание визуальных элементов
   - Запросит возврат данных в формате JSON
4. Обработай ответ от OpenAI API и преобразуй его в структурированный формат для дальнейшего использования

### Шаг 3: Создание сервиса построения презентации
1. Разработай сервис, который преобразует полученный контент в структуру презентации
2. Реализуй функции для:
   - Применения выбранного стиля к слайдам (цвета, шрифты, фоны)
   - Добавления заголовков и текстового содержимого
   - Обработки маркированных списков
   - Создания плейсхолдеров для визуальных элементов или генерации простых визуальных элементов

### Шаг 4: Разработка сервиса экспорта презентаций
1. Создай функции для экспорта презентации в PPTX:
   - Используй библиотеку PptxGenJS для создания файла презентации
   - Реализуй преобразование структуры презентации в формат PptxGenJS
   - Добавь поддержку различных элементов: заголовки, текст, списки, изображения, графики
2. Создай функции для экспорта презентации в PDF:
   - Используй библиотеку PDFKit для создания PDF-документа
   - Реализуй преобразование структуры презентации в PDF-страницы
   - Добавь поддержку тех же элементов, что и для PPTX

### Шаг 5: Настройка API и маршрутов
1. Создай маршрут для генерации презентации:
   - POST запрос с параметрами презентации
   - Последовательный вызов сервисов:
     * Генерация контента
     * Построение презентации
     * Экспорт в выбранный формат
   - Возврат ссылки на скачивание готовой презентации
2. Создай маршрут для скачивания готовой презентации:
   - GET запрос с именем файла
   - Проверка существования файла
   - Отправка файла пользователю

### Шаг 6: Разработка пользовательского интерфейса
1. Создай простую веб-страницу с формой, содержащей:
   - Поле для ввода темы презентации
   - Выбор количества слайдов
   - Выбор формата экспорта (PPTX или PDF)
   - Поле для описания целевой аудитории
   - Поле для дополнительных требований
   - Выбор стиля презентации
   - Кнопку для отправки запроса
2. Добавь обработку формы с:
   - Валидацией введённых данных
   - Отправкой AJAX-запроса к API
   - Отображением статуса генерации
   - Показом ссылки для скачивания по завершении

### Шаг 7: Оптимизация и улучшения
1. Реализуй кэширование для уменьшения количества запросов к OpenAI API
2. Добавь предварительный просмотр генерируемой презентации
3. Реализуй расширенные настройки стилей и форматирования
4. Предоставь возможность редактировать сгенерированное содержимое перед экспортом

## Подробности реализации ключевых компонентов:

### Интеграция с OpenAI API
1. Промпт должен быть чётко структурирован для получения управляемых результатов
2. Устанавливай параметры запроса:
   - temperature: 0.7 (баланс между креативностью и предсказуемостью)
   - max_tokens: 2500 (достаточно для генерации презентации из 10-15 слайдов)
   - model: gpt-4 или gpt-3.5-turbo (в зависимости от требуемого качества и бюджета)
3. Обрабатывай исключения и реализуй повторные попытки при ошибках API

### Работа с PptxGenJS для создания PPTX
1. Организуй работу со слайдами:
   - Создание новых слайдов
   - Добавление заголовков с правильным форматированием
   - Создание маркированных списков для ключевых пунктов
   - Вставка текстовых блоков с форматированием
2. Реализуй поддержку визуальных элементов:
   - Добавление изображений (можно использовать плейсхолдеры или генерировать с DALL-E)
   - Создание простых диаграмм и графиков на основе данных
   - Оформление слайдов с помощью фигур и других элементов дизайна
3. Настрой стилизацию:
   - Применение цветовых схем в зависимости от выбранного стиля
   - Использование подходящих шрифтов
   - Создание единообразного оформления всех слайдов

### Работа с PDFKit для создания PDF
1. Настрой создание страниц:
   - Установка ориентации и размера страниц (обычно 16:9 или 4:3)
   - Добавление нумерации страниц
   - Создание колонтитулов
2. Реализуй форматирование текста:
   - Настройка шрифтов для заголовков и основного текста
   - Создание маркированных списков
   - Выделение ключевых фраз
3. Добавь поддержку изображений и графики:
   - Вставка изображений
   - Отрисовка простых диаграмм и графиков
   - Добавление декоративных элементов

## Пример запроса к OpenAI API для генерации презентации:

```
Создай структуру и контент для презентации на тему "{ТЕМА}".
Количество слайдов: {КОЛИЧЕСТВО}
Аудитория: {АУДИТОРИЯ}
Дополнительная информация: {ДОПОЛНИТЕЛЬНАЯ_ИНФОРМАЦИЯ}

Для каждого слайда укажи:
1. Заголовок
2. Основной текст или ключевые пункты (в виде маркированного списка)
3. Описание необходимых визуальных элементов (графики, диаграммы, изображения)

Структура презентации должна включать:
- Титульный слайд
- Введение/Обзор
- Основное содержание (разбитое на логические разделы)
- Заключение/Выводы

Вывод должен быть в формате JSON:
{
  "title": "Название презентации",
  "slides": [
    {
      "type": "title",
      "title": "Заголовок слайда",
      "subtitle": "Подзаголовок (если есть)"
    },
    {
      "type": "content",
      "title": "Заголовок слайда",
      "bulletPoints": ["Пункт 1", "Пункт 2", "Пункт 3"],
      "visualElements": [
        {
          "type": "image",
          "description": "Описание изображения"
        }
      ]
    }
    // и так далее для всех слайдов
  ]
}
```

## Рекомендуемые библиотеки для разработки

### Основные библиотеки
- **express**: для создания веб-сервера и API
- **openai**: официальный SDK для работы с OpenAI API
- **pptxgenjs**: мощная библиотека для создания PPTX-презентаций
- **pdfkit**: гибкая библиотека для создания PDF-документов
- **axios**: для выполнения HTTP-запросов

### Дополнительные библиотеки
- **chart.js**: для создания диаграмм и графиков
- **uuid**: для генерации уникальных идентификаторов
- **multer**: если требуется загрузка файлов пользователями
- **dotenv**: для работы с переменными окружения
- **winston**: для логирования

## Советы по оптимизации
1. Кэшируй результаты генерации для похожих запросов
2. Используй очередь задач, если ожидается высокая нагрузка
3. Реализуй ограничение скорости запросов к OpenAI API
4. Устанавливай таймауты для всех внешних API-запросов
5. Реализуй сжатие и оптимизацию созданных презентаций

## Расширение функциональности
1. Добавь поддержку различных языков
2. Реализуй выбор из предустановленных шаблонов
3. Добавь возможность загрузки собственных изображений и логотипов
4. Интегрируй генерацию изображений с помощью DALL-E или Midjourney
5. Реализуй возможность сохранения и редактирования презентаций